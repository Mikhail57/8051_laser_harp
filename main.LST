C51 COMPILER V9.57.0.0   MAIN                                                              03/07/2018 21:47:57 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\build\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.exe main.c ROM(COMPACT) OPTIMIZE(8,SPEED) TABS(2) OBJECT(.\build\main.obj)

line level    source

   1          #include <reg52.h>
   2          #include "timers.h"
   3          
   4          #define A1 182
   5          #define B1 161
   6          #define C1 153
   7          #define D1 136
   8          #define E1 121
   9          #define F1 114
  10          #define G1 102
  11          
  12          /*
  13          Inverse order of bits in this way:
  14          abcdefgh - efghabcd - ghefcdab - hgfedcba
  15          */
  16          unsigned char invert(unsigned char b) {        
  17   1        b = ((b >> 4) & 15) | ((b & 15) << 4);
  18   1        b = ((b >> 2) & 51) | ((b & 51) << 2);
  19   1        b = ((b >> 1) & 85) | ((b & 85) << 1);
  20   1        return b;
  21   1      }
  22          
  23          unsigned char resValues;
  24          unsigned char tone = 1;
  25          unsigned start_count;
  26          unsigned current_count;
  27          unsigned diff;
  28          
  29          sbit P3_4 = P3 ^ 4;
  30          
  31          sbit A = P2 ^ 7;
  32          sbit _B = P2 ^ 6;
  33          sbit C = P2 ^ 5;
  34          sbit D = P2 ^ 4;
  35          sbit E = P2 ^ 3;
  36          sbit F = P2 ^ 2;
  37          sbit G = P2 ^ 1;
  38          sbit pitchButton = P2 ^ 0;
  39          
  40          void setup() {
  41   1        timer0_initialize();
  42   1        P2 = 0xFF;
  43   1        start_count = timer0_count();
  44   1      }
  45          
  46          void loop() {
  47   1        resValues = invert(P2); // assign to resValues reversed in numeric order values of photoresistors
  48   1        resValues = ~resValues; // Inverse values of resistors to match 1 -- high, 0 -- low
  49   1        P1 = resValues; // Display active notes on LEDs
  50   1      
  51   1        if (A)
  52   1          diff = A1;
  53   1        else if (_B)
  54   1          diff = B1;
  55   1        else if (C)
C51 COMPILER V9.57.0.0   MAIN                                                              03/07/2018 21:47:57 PAGE 2   

  56   1          diff = C1;
  57   1        else if (D)
  58   1          diff = D1;
  59   1        else if (E)
  60   1          diff = E1;
  61   1        else if (F)
  62   1          diff = F1;
  63   1        else if (G)
  64   1          diff = G1;
  65   1        else diff = 0;
  66   1        
  67   1        current_count = timer0_count();
  68   1        if ((diff != 0) && (current_count - start_count <= diff)) {
  69   2          start_count = current_count;
  70   2          P3_4 ^= 1;
  71   2        } else {
  72   2          P3_4 = 0;
  73   2        }
  74   1      
  75   1      }
  76          
  77          /*------------------------------------------------
  78          MAIN C Function
  79          ------------------------------------------------*/
  80          
  81          void main (void) {
  82   1        setup();
  83   1        
  84   1        while (1) 
  85   1          loop();
  86   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    205    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     10    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
